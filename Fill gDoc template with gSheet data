function Offcycle_Letters() {
 //This value should be the id of your document template
  const googleDocTemplate = DriveApp.getFileById('1Y06xZnxq9MugITbMgEksqNZCzlS3GnzZ-VMHtFFWcX8');
  
  //This value should be the id of the folder where you want to store EDITABLE documents
  const destinationFolder = DriveApp.getFolderById('1gLANnt7Q2HnuXOhrA3no9ALTSAt6mNtA');

  //This value should be the id of the folder where you want to store PDF documents
  const pdfFolder = DriveApp.getFolderById('1f7gAufwe5zNi9oYM06Q3y2PvTwvY59Lp');

  //Here we store the sheet as a variable
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Offcycle Letters");

    //Now we get all of the values as a 2D array
  const rows = sheet.getDataRange().getValues();
  
  //Start processing each spreadsheet row
  rows.forEach(function(row, index){
    //Here we check if this row is the headers, if so we skip it
    if (index === 0) return;
    //Here we check if a document has already been generated by looking at 'Document Link', if so we skip it
    if (row[8]) return;
    //Using the row data in a template literal, we make a copy of our template document in our destinationFolder
    const copy = googleDocTemplate.makeCopy('Offcycle Letter for ' + row[0], destinationFolder);
    //Once we have the copy, we then open it using the DocumentApp
    const doc = DocumentApp.openById(copy.getId());
    //All of the content lives in the body, so we get that for editing
    const body = doc.getBody();
    
    //In these lines, we replace our replacement tokens with values from our spreadsheet row
    body.replaceText('{{Letter Date}}', row[6]);
    body.replaceText('{{EE Full Name}}', row[0]);
    body.replaceText('{{Manager Full Name}}', row[3]);
    body.replaceText('{{EE First Name}}', row[1]);
    body.replaceText('{{New Salary}}', (row[5]));
    body.replaceText('{{Effective Date}}', row[7]);
    body.replaceText('{{Manager Title}}', row[4]);
    
    //PLAYTIME - HELLO PARAGRAPH EDIT OR DELETE
    const helloparagraph = body.getParagraphs()[14];
    if(row[9] === "Yes"){
      body.replaceText('{{TEST}}', row[10]);
    }
    else{
      helloparagraph.getParent().removeFromParent
    }
    
    //We make our changes permanent by saving and closing the document
    doc.saveAndClose();

    //Store the url of our new document in a variable
    const url = doc.getUrl();

    //Write that value back to the 'Document Link' column in the spreadsheet.
    sheet.getRange(index + 1, 9).setValue(url);

    //Save as PDF
    const BLOBPDF = doc.getAs("application/pdf");
     BLOBPDF.setName("Offcycle Letter for " + row[0] + ".pdf");
    const pdfFile = pdfFolder.createFile(BLOBPDF)

  })
  
}
